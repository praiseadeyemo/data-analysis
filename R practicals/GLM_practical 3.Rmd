---
title: "Practical 3"
author: "Praise Adeyemo"
date: "2024-10-04"
output:
  word_document: default
  html_document: default
---
###################
#Practical 3 - Identifying and understanding colinearity

```{r}
setwd("~/Documents/UofG PhD Masterfile/KRS 2024/GLM/Practical 3")
library(readr)
lichens <- read_csv("lichens.csv")
View(lichens)

#Research question: Does Lichen dry weight (dryweight) vary as a function of the pH value (pH), the nitrate concentration in the soil (nitrogen) and the water content of the soil (water)?

lichens$nitrogen<-factor(lichens$nitrogen) #to change nitrogen which is currently a numerical variable in the dataset to a factor or categorical variable
str(lichens$nitrogen) #now showing nitrogen as a categorical variable/factor with four levels

lichens$water<-factor(lichens$water) #to change water which is currently a numerical variable in the dataset to a factor or categorical variable
str(lichens$water) #now showing water as a categorical variable/factor with four levels


#Q1: Defining the hypotheses
#H0 for explanatory variable 1: Lichen dry weight does not vary as a function of the pH value
#Ha for explanatory variable 1: Lichen dry weight varies as a function of the pH value

#H0 for explanatory variable 2: Lichen dry weight does not vary as a function of nitrate concentration in the soil
#Ha for explanatory variable 2: Lichen dry weight varies as a function of nitrate concentration in the soil

#H0 for explanatory variable 3: Lichen dry weight does not vary as a function of water content in the soil
#Ha for explanatory variable 3: Lichen dry weight varies as a function of water content in the soil


#Q2: Identifying the response and explanatory variables
#Response variable is dryweight
#Explanatory variables are pH, nitrogen and water
#pH is a continuous covariate
#nitrogen and water are both ordinal factors with 4 levels each


#Q3: Plots
library(ggplot2)
ggplot(data = lichens, aes(x=pH, y=dryweight)) + 
  geom_point() #since pH is a covariate, a scatter plot is needed
#For the dryweight/pH plot, there seems to be a positive relationship between the dry weight of the Lichens and the pH value, with a lot of variations
ggplot(data = lichens, aes(x=nitrogen, y=dryweight)) +
  geom_boxplot() #since nitrogen is a factor, a box plot is needed
#For the dryweight/nitrogen plot, nitrate concentration in the soil seems to explain the dry weight, with little variations
ggplot(data = lichens, aes(x=water, y=dryweight)) +
  geom_boxplot() #since water is a factor, a box plot is needed
#There seems to be no relationship between the dry weight and the water


#Q4: Fitting a model
model <- lm (dryweight ~ pH + nitrogen + water, data=lichens) #fitting a model with all three explanatory variables
anova(model) #to obtain the model outcome
summary(model) #to view residuals, co-efficients 


#Q5: Checking the model assumptions - Normality of residuals
hist(rstandard(model)) #to plot a histogram of the model residuals to aid "eyeball" of the normality of distribution
#From the histogram, the residuals seem to be normally distributed
plot(model,which=c(2)) #to plot a quantile-quantile plot of the model residuals


#Q6: Checking the model assumptions - Independence of residuals
plot(rstandard(model),type="l") 
points(rstandard(model),pch=1, col="darkorange") 
#There is no serial pattern in the residuals
#I don't think there are any dependencies between the residuals in this model


#Q7: Checking the model assumptions - Homoscedasticity (constant variance)
plot(lichens$dryweight~lichens$nitrogen) #to eyeball the consistency of variance in the nitrogen variable
#Non-constant variance - heteroscedasticity 
plot(lichens$dryweight~lichens$water) #to eyeball the consistency of variance in the water variable
#Constant variance - homoscedasticity 
plot(lichens$dryweight~lichens$pH) #to eyeball the consistency of variance in the pH variable
#Unequal variance - heteroscedasticity 


#Q8:
#Reject H0 for x1 (pH) and x2 (nitrogen)
#Accept H0 for x3 (water)


#Q9: Algebraic formula for model
# y = m * pH + [nitrogen 1 | nitrogen 2 | nitrogen 3 | nitrogen 4] + [water 1 | water 2 | water 3 | water 4] + c 
#where y is the dry weight, m is the slope or covariate estimate, pH is the covariate explanatory variable,  nitrogen and water are factors indicated at each level
#for the first level for factors, the intercept is always 0
#kindly recall that the formula for a normal x-y axis is y=mx+c

#Q10: 
# for pH: dryweight = 0.81653 * pH + 0.81653
# for nitrogen level 2: dryweight = 0.19048 + 0.81653


#Q11: Predicted value for nitrogen level 1, water level 3 and pH 5
#y = m*pH + nitrogen level 1 + water level 3 + intercept
dryweight<-0.17218*5 + 0 + 0.8964 +  0.81653 
dryweight #2.57383




```
